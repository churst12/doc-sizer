<!DOCTYPE html>
<html>
<head>
<style>
/* Tooltip container */
.tooltip {
    position: relative;
    display: inline-block;
}

/* Tooltip text */
.tooltip .tooltiptext {
    visibility: hidden;
    width: 120px;
    background-color: #f1f1f1;
    color: #444444;
    text-align: center;
    padding: 5px 0;
    border-radius: 6px;
 
    /* Position the tooltip text - see examples below! */
    position: absolute;
    z-index: 1;
    bottom: 100%;
    left: 50%;
    margin-left: -60px;
}

/* Show the tooltip text when you mouse over the tooltip container */
.tooltip:hover .tooltiptext {
    visibility: visible;
}

#slidecontainer {
    width: 100%; /* Width of the outside container */
}

/* The slider itself */
.slider {
    -webkit-appearance: none;  /* Override default CSS styles */
    appearance: none;
    width: 80%; /* Full-width */
    height: 10px;
    border-radius: 5px;
    background: #d8d8d8;
    outline: none; /* Remove outline */
}

/* The slider handle (use webkit (Chrome, Opera, Safari, Edge) and moz (Firefox) to override default look) */ 
.slider::-webkit-slider-thumb {
    -webkit-appearance: none; /* Override default look */
    appearance: none;
    width: 15px; /* Set a specific slider handle width */
    height: 15px;
    border-radius: 50%; 
    background: #999999; /* Green background */
    cursor: pointer; /* Cursor on hover */
}

.slider::-moz-range-thumb {
    width: 25px; /* Set a specific slider handle width */
    height: 25px;
    border-radius: 50%;
    background: #4CAF50; /* Green background */
    cursor: pointer; /* Cursor on hover */
}

ul li {
    margin: 5px;
    padding: 0px;
}
.settings {
    position: absolute;
    bottom: 10px;
    left: 10px;
}
</style>
<base target="_top">
<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script>
function lineAlert(lines) {
var textLines = "";
   for(i=0; i<lines.length; i++) {
         textLines += lines[i] + "***";
   }
   
   var text = document.getElementById("text");
   text.innerHTML = textLines;
}
function doOverflow(value) {
   var success = false;
   if(value) {
      google.script.run.printText(); //withSuccessHandler later when can retrieve lines to be edited
      success = true;
   }
   else {
      success = true;
   }
   return success;
}
function doPunctReplace(value) {
   var success = false;
   if(value) {
      google.script.run.punctReplace("[.]", 14);
      success = true;
   }
   else {
      google.script.run.punctReplace("[.]", 11);
      success = true;
   }
   return success;
}
function doWordExpand(value) {
   if(value) {
      google.script.run.wordExpand();    
   }
   else {
   
   }
   return true;
}

function doWordContract(value) {
   if(value) {
      google.script.run.wordContract();    
   }
   else {
   
   }
   return true;
}

function doLineSpacing(value) {
   if(value) {
      google.script.run.lineSpacing(value);
   }
   return true;

}

function apply() {
  var overflowCheck = document.getElementById('overflow').checked;
  var replaceCheck = document.getElementById('replace').checked;
  var wordExpandCheck = document.getElementById('wordExpand').checked;
  var wordContractCheck = document.getElementById('wordContract').checked;
  var t1 = doOverflow(overflowCheck);
  var t2 = doPunctReplace(replaceCheck);
  var t3 = doWordExpand(wordExpandCheck);
  var t4 = doWordContract(wordContractCheck);
  
  doLineSpacing(parseFloat(document.getElementById("myRange").value));
  if( t1 && t2 && t3 && t4) {
     var text = document.getElementById("text");
     text.innerHTML = "Changes Applied.";
  }
  else {
     var text = document.getElementById("text");
     text.innerHTML = "Apply Unsuccessful";
     console.log(t1 + " " + t2 +" " +  t3 + "" + t4);
  }
}

function settings() {
   google.script.run.settingsPage();
}
    
</script>
</head>
  <body>
  
    <br><b> Tools </b><br>
    <ul style="list-style-type:none">
    <li>
       <input id='overflow'type='checkbox'>
       <label>Line OverFlow&nbsp&nbsp</label> 
       <span class="tooltip"> <i class="material-icons" style="font-size:15px">info_outline</i>
          <span class="tooltiptext" >information </span>
       </span>
    </li>
    <li>
       <input id='replace'type='checkbox' >
       <label>Puctuation Replace&nbsp&nbsp</label>
       <span class="tooltip"> <i class="material-icons" style="font-size:15px">info_outline</i>
          <span class="tooltiptext" >information </span>
       </span>
    </li>
    <li>
       <input id='wordExpand'type='checkbox' >
       <label>Word Expand&nbsp&nbsp</label>
       <span class="tooltip"> <i class="material-icons" style="font-size:15px">info_outline</i>
          <span class="tooltiptext" >information </span>
       </span>
    </li>
    <li>
       <input id='wordContract'type='checkbox' >
       <label>Word Contractor&nbsp&nbsp</label>
       <span class="tooltip"> <i class="material-icons" style="font-size:15px">info_outline</i>
          <span class="tooltiptext" >information </span>
       </span>
    </li>
    <li>
       <div id="slidecontainer">
          <input type="range" min="1" max="3" value="1" class="slider" id="myRange" step="0.01">
          <span id="demo"></span>
       </div>
       <script>
          var slider = document.getElementById("myRange");
          var output = document.getElementById("demo");
          output.innerHTML = slider.value;
       
          slider.oninput = function() {
             output.innerHTML = this.value;
          }
       </script>
    </li>
    </ul>
    <p align="center" ><button class="blue" type="button" onclick="apply();" id="applyButton">Apply</button><br></p>
    <p align="center" id="text"> </p>
    <span class="settings"> 
       <button class="gray" type="button" onclick="settings();" id="settingsButton"> 
          <i class="material-icons">settings</i>
       </button>
    </span>
    

  </body>
</html>


